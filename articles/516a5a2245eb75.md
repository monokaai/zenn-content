---
title: "Redashç’°å¢ƒã‚’Docker Composeã§æ§‹ç¯‰"
emoji: " ðŸ˜ƒ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["redash", "analytics"]
published: true
---

# ç’°å¢ƒ

- macOS Ventura 13.4.1
- [å½“æ™‚ã®HEAD](https://github.com/getredash/redash/commit/36482f6717140dd93578aed55ad100721c5dcd2b)

# ã‚¯ãƒ­ãƒ¼ãƒ³ã€ãƒ“ãƒ«ãƒ‰

ã¾ãšã¯å…¬å¼ãƒ¬ãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã€‚

```bash
% git clone https://github.com/getredash/redash.git
```

ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹ãŸã‚ `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

ä»¥ä¸‹ã®å€¤ã ã‘ã¯å¿…é ˆã‚‰ã—ãã€æœªè¨­å®šã ã¨ã‚³ãƒ³ãƒ†ãƒŠã®ãƒ“ãƒ«ãƒ‰ãƒ»ç«‹ã¡ä¸Šã’ãŒå¤±æ•—ã—ã¦ã—ã¾ã„ã¾ã™ã€‚

```bash
% REDASH_COOKIE_SECRET='my_redash_dashboard' # change for production
```

ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ã‚³ãƒ³ãƒ†ãƒŠã‚’ç«‹ã¡ä¸Šã’ã¾ã™ã€‚

```bash
% docker-compose up -d
```

# Nodeãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
% yarn --frozen-lockfile
```

ã“ã“ã§ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚

```bash
error redash-client@23.9.0-dev: The engine "node" is incompatible with this module. Expected version ">14.16.0 <17.0.0". Got "17.3.0"
error Found incompatible module.
```

Node.jsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä¸€è‡´ã—ã¦ã„ãªã„ã®ã§ã€é©å½“ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã‚„ã‚‹ã€‚ver.17æœªæº€ã®æœ€æ–°ç‰ˆå½“ãŸã‚ŠãŒè‰¯ã•ãã†ã§ã™ã€‚

```bash
$ nodenv install --list | grep 16. | tail
â†“
16.7.0
16.8.0
16.9.0
16.9.1
16.10.0
16.11.0
16.11.1
16.12.0
16.13.0
16.13.1

$ nodenv install 16.13.1
```

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããŸã‚‰ã€ç¢ºèªã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®åˆ‡ã‚Šæ›¿ãˆã‚’è¡Œã„ã¾ã™ã€‚

```bash
monokaai@MacBook-Air redash % nodenv versions
  system
  16.13.1
* 17.3.0 (set by /Users/monokaai/.anyenv/envs/nodenv/version)
monokaai@MacBook-Air redash % nodenv local 16.13.1
monokaai@MacBook-Air redash % nodenv versions     
  system
* 16.13.1 (set by /Users/monokaai/work/redash/.node-version)
  17.3.0
```

 `node -v`ã—ã¦ã‚‚16.13.1ã«ãªã£ã¦ã„ãªã‹ã£ãŸã®ã§ã€è»½ããƒãƒžã‚Šã¾ã—ãŸã€‚ã“ã‚Œã¯~/.zshrcã«nodenvã®åˆæœŸåŒ–å‡¦ç†ã‚’æ›¸ã„ã¦ã„ãªã„ãŸã‚ã§ã—ãŸã€‚

ä»¥ä¸‹ã®å‡¦ç†ã‚’è¿½åŠ ã—ã¦ `source ~/.zshrc`ã§å†èµ·å‹•ã™ã‚Œã°OKã§ã—ãŸã€‚

```bash
# nodenvã®åˆæœŸåŒ–
eval "$(nodenv init -)"
```

# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆå†ãƒˆãƒ©ã‚¤ï¼‰

yarnã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ãƒªãƒˆãƒ©ã‚¤ã€‚

```bash
% npm install -g yarn
% yarn -- frozen -lockfile
```

## Apple Silicon Macå‘ã‘å¯¾å¿œ

é †èª¿ã«è¦‹ãˆãŸã®ã§ã™ãŒã€[Puppeteer](https://pptr.dev/)ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®éš›ã«ARM64å‘ã‘ã®Chromium-binaryãŒæä¾›ã•ã‚Œã¦ã„ãªã„ã¨ã®ã“ã¨ã€‚

```bash
error /Users/monokaai/work/redash/node_modules/puppeteer: Command failed.
Exit code: 1
Command: node install.js
Arguments: 
Directory: /Users/monokaai/work/redash/node_modules/puppeteer
Output:
The chromium binary is not available for arm64: 
If you are on Ubuntu, you can install with: 

 apt-get install chromium-browser
```

brewã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã€

```bash
brew install chromium
â†“
monokaai@MacBook-Air redash % which chromium
/opt/homebrew/bin/chromium
```

`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«ç’°å¢ƒå¤‰æ•°ã‚’è¿½è¨˜ã—ã¦ `source .env`ã§èª­è¾¼ã¿ã¾ã™ãŒã€ã“ã‚Œã ã‘ã¯å‹•ãã¾ã›ã‚“ã§ã—ãŸã€‚

```bash
PUPPETEER_EXECUTABLE_PATH=/usr/bin/chromium
```

çµå±€[ã“ã¡ã‚‰ã®å¯¾å¿œ](https://zenn.dev/sjbworks/articles/d5f986a1c409a1)ã§è§£æ±ºã—ã¾ã—ãŸã€‚

```bash
$ export PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true
$ yarn --frozen-lockfile
```

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆã€UIãƒ“ãƒ«ãƒ‰

ã‚„ã£ã¨ã“ã“ã¾ã§æ¥ã¾ã—ãŸã€‚

```bash
$ docker-compose run --rm server create_db
$ yarn build
```

ã“ã‚Œã§ç’°å¢ƒãŒæ§‹ç¯‰ã•ã‚ŒãŸã®ã§ã€[http://localhost:5001](http://localhost:5001/)ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã¾ã™ã€‚

ç„¡äº‹ã«ç™»éŒ²ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚

![Untitled](/images/516a5a2245eb75.md/img1.png)

ç™»éŒ²ã‚’æ¸ˆã¾ã›ãŸã‚‰ã€ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸï¼

![Untitled](/images/516a5a2245eb75.md/img2.png)

# å‚è€ƒ

[https://github.com/getredash/redash](https://github.com/getredash/redash)

[Docker Based Developer Installation Guide](https://redash.io/help/open-source/dev-guide/docker)

[ã€2022å¹´1æœˆç‰ˆã€‘Redashã‚’Docker Desktopã§ä½¿ã£ã¦ã¿ã‚‹ - Qiita](https://qiita.com/tsumuchan/items/f50f97f8c4f75953e731)